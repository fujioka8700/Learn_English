# 英語学習アプリ 要件定義書

## 1. プロジェクト概要

### 1.1 目的

中学 1 年〜3 年レベルの英単語を効率的に学習できる Web アプリケーションを開発する。
**誰でも登録なしで利用できる**ことを前提とした設計とする。

### 1.2 対象ユーザー

- 中学生（中 1、中 2、中 3）
- 英単語を基礎から学び直したい人
- 英単語の暗記を効率的に行いたい人
- **登録不要で気軽に使いたい人（ゲストユーザー）**

## 2. 機能要件

### 2.0 アクセシビリティ要件

- **誰でも使える設計**: ユーザー登録なしで全機能を利用可能
- **ゲストモード**: 登録不要で単語学習、クイズ、フラッシュカードなどの基本機能を利用可能
- **ローカルストレージ活用**: ゲストユーザーの学習進捗はブラウザのローカルストレージに保存
- **オプション登録**: 学習履歴を永続的に保存したい場合のみユーザー登録を提供

### 2.1 英単語学習機能

- **単語一覧表示**: 中 1、中 2、中 3 レベルの英単語を一覧で表示（レベル別フィルタリング対応）
- **単語詳細表示**: 各英単語の意味、品詞、例文などを表示
- **学習モード**:
  - フラッシュカード形式での学習
  - **4 択クイズ形式での学習**（詳細は 2.1.1 を参照）
  - スペル練習機能
- **進捗管理**: 学習した単語の記録と進捗状況の可視化

### 2.1.1 4 択クイズ機能の詳細仕様

- **クイズ形式**: 4 択問題（1 つの正解と 3 つの選択肢）
- **問題の出題方法**:
  - 英単語を見て日本語の意味を選ぶ形式
  - または、日本語の意味を見て英単語を選ぶ形式
- **時間制限**:
  - **最初の質問の回答時間制限: 10 秒**
  - 以降の質問は設定可能（デフォルト: 制限なし、または設定可能）
- **カウントダウンタイマー**:
  - **進捗バーがカウントダウンタイマーとして機能**: 残り時間を視覚的に表示
  - タイマーは 10 秒から 0 秒までカウントダウン
  - 残り時間が少なくなるにつれて進捗バーが減少（視覚的なフィードバック）
- **時間切れ時の動作**:
  - **時間が 0 に達した場合、その問題は自動的に「間違い」として扱う**
  - **時間切れ後、自動的に次の問題に進む**（ユーザーの操作不要）
  - 時間切れの場合は、正解の選択肢をハイライト表示してから次の問題へ遷移
- **進捗表示**:
  - **問題のシーケンス（順序）を表示**: 現在何問目か、全体で何問かを表示（例: 3/10）
  - 進捗バーで視覚的に表示（カウントダウンタイマーと統合）
- **結果表示**:
  - クイズ終了後に結果画面を表示
  - 正解数/総問題数
  - 正答率（パーセンテージ）
  - 各問題の正解/不正解の表示
  - 間違えた問題の復習機能
- **回答後のフィードバック**:
  - 正解/不正解の即座な表示
  - 正解の選択肢をハイライト表示
  - **次の問題への自動遷移**: 回答後または時間切れ後、一定時間（例: 1-2 秒）経過後に自動的に次の問題へ進む
  - 時間切れの場合も同様に自動遷移

### 2.2 単語検索・フィルタ機能

- 英単語の検索機能
- 日本語での検索機能
- アルファベット順でのソート
- レベル別フィルタリング（中 1/中 2/中 3）
- 学習状況によるフィルタリング（未学習/学習中/習得済み）

### 2.3 ユーザー管理機能

- **ゲストモード**: ユーザー登録なしで基本的な学習機能を利用可能
- **ユーザー登録・ログイン機能**: 任意（学習履歴を保存したい場合のみ）
- **学習履歴の保存**: ログインユーザーのみ
- **個人の学習統計の表示**: ログインユーザーのみ
- **ローカルストレージ活用**: ゲストユーザーはブラウザのローカルストレージで一時的な学習記録を保存可能

## 3. データソース

### 3.1 英単語データ

- **データソース URL**:
  - 中学 1 年レベル: https://agreatdream.com/word-list-junior-high-school-1st-year/
  - 中学 2 年レベル: https://agreatdream.com/word-list-junior-high-school-2nd-year/
  - 中学 3 年レベル: https://agreatdream.com/word-list-junior-high-school-3rd-year/
- **データ内容**: 中 1、中 2、中 3 で学習する主要な英単語とその日本語訳
- **データ形式**: 表形式（英単語 | 日本語訳）

### 3.2 データ取得方法

- 初期データは手動でデータベースにインポート
- 将来的にはスクレイピング機能の実装も検討

## 4. 技術スタック

### 4.1 フロントエンド

- **フレームワーク**: Next.js (TypeScript)
- **UI ライブラリ**: 未定（必要に応じて検討）

### 4.2 バックエンド

- **API**: Next.js API Routes
- **ORM**: Prisma
- **データベース**: PostgreSQL

### 4.3 インフラ

- **コンテナ**: Docker
- **データベース**: PostgreSQL (Docker Compose)

## 5. データモデル

### 5.1 英単語（Word）

```prisma
model Word {
  id          Int      @id @default(autoincrement())
  english     String   @unique  // 英単語
  japanese    String   // 日本語訳
  level       String   @default("中1")  // レベル（中1/中2/中3）
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  userWords   UserWord[]
}
```

### 5.2 ユーザー（User）

```prisma
model User {
  id        Int       @id @default(autoincrement())
  email     String    @unique
  name      String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  userWords UserWord[]
}
```

### 5.3 ユーザー学習記録（UserWord）

```prisma
model UserWord {
  id            Int      @id @default(autoincrement())
  userId        Int
  wordId        Int
  status        String   @default("未学習")  // 未学習/学習中/習得済み
  correctCount  Int      @default(0)  // 正解回数
  mistakeCount  Int      @default(0)  // 間違い回数
  lastStudiedAt DateTime?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  user          User     @relation(fields: [userId], references: [id])
  word          Word     @relation(fields: [wordId], references: [id])

  @@unique([userId, wordId])
}
```

## 6. UI/UX 要件

### 6.1 デザイン方針

- シンプルで使いやすいインターフェース
- **誰でも迷わず使える直感的な UI**
- 学習に集中できるデザイン
- モバイル対応（レスポンシブデザイン）
- **登録を促す強制的なポップアップやモーダルは表示しない**

### 6.2 主要画面

1. **ホーム画面**: 学習進捗の概要表示
2. **単語一覧画面**: 全単語の一覧表示
3. **学習画面**: フラッシュカード形式の学習
4. **クイズ画面**: 4 択クイズ形式の学習
   - 問題表示エリア
   - 4 つの選択肢ボタン
   - **カウントダウンタイマー（進捗バー形式）**: 残り時間を視覚的に表示、10 秒から 0 秒までカウントダウン
   - 進捗表示（現在の問題番号/総問題数）
   - **時間切れ時の自動処理**: 時間が 0 に達すると自動的に「間違い」として扱い、次の問題へ自動遷移
   - 回答後の自動遷移: 回答後または時間切れ後、一定時間経過後に自動的に次の問題へ進む
   - 結果画面（クイズ終了後）
5. **統計画面**: 学習状況の可視化

## 7. 非機能要件

### 7.1 パフォーマンス

- ページ読み込み時間: 2 秒以内
- データベースクエリの最適化

### 7.2 セキュリティ

- ユーザー認証の実装（任意、ゲストモードもサポート）
- SQL インジェクション対策（Prisma 使用により自動対応）
- XSS 対策
- ゲストユーザーでも安全に利用できる設計

### 7.3 可用性

- エラーハンドリングの実装
- 適切なエラーメッセージの表示

## 8. 開発フェーズ

### Phase 1: 基礎機能実装

- データベース設計・構築
- 英単語データのインポート
- **ゲストモードでの単語一覧表示機能（登録不要）**
- **ゲストモードでの基本的な検索機能（登録不要）**

### Phase 2: 学習機能実装

- **ゲストモードでのフラッシュカード機能（ローカルストレージで進捗保存）**
- **ゲストモードでの 4 択クイズ機能**:
  - 4 択問題の実装
  - 最初の質問の 10 秒時間制限機能
  - **カウントダウンタイマー（進捗バー形式）の実装**: 10 秒から 0 秒までカウントダウン表示
  - 問題シーケンス（順序）の表示
  - 進捗バーの実装（カウントダウンタイマーと統合）
  - **時間切れ時の自動処理**: 時間が 0 に達した場合、自動的に「間違い」として扱い、次の問題へ自動遷移
  - **回答後の自動遷移機能**: 回答後または時間切れ後、一定時間経過後に自動的に次の問題へ進む
  - 結果画面の実装（正解数、正答率、間違えた問題の表示）
  - 回答後のフィードバック表示
- 学習進捗の記録（ローカルストレージ / データベース）

### Phase 3: ユーザー機能実装（オプション）

- ユーザー登録・ログイン（任意）
- 個人の学習履歴管理（データベース保存）
- 統計機能（ログインユーザー向け）
- ゲストモードからログインモードへの移行機能

### Phase 4: UI 改善・最適化

- デザインの改善
- パフォーマンス最適化
- モバイル対応の強化

## 9. 参考資料

- 英単語データソース:
  - 中学 1 年レベル: https://agreatdream.com/word-list-junior-high-school-1st-year/
  - 中学 2 年レベル: https://agreatdream.com/word-list-junior-high-school-2nd-year/
  - 中学 3 年レベル: https://agreatdream.com/word-list-junior-high-school-3rd-year/
- 札幌英会話スクール AGREATDREAM

## 10. 今後の拡張案

- 高校レベルの英単語への対応
- 音声読み上げ機能
- 単語帳のエクスポート機能
- 学習リマインダー機能
- ゲーミフィケーション要素の追加（バッジ、ランキングなど）
